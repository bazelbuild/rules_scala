# scalapb_proto_library

To use this rule, you'll first need to add the following to your `WORKSPACE` file,
which adds a few dependencies needed for ScalaPB:

```python
load("@io_bazel_rules_scala//scalapb:scalapb.bzl", "scalapb_repositories")
scalapb_repositories(scala_version = "2.12.8") # or whatever scala_version you're on
```

Then you can import `scalapb_proto_library` in any `BUILD` file like this:

```python
load("@io_bazel_rules_scala//scalapb:scalapb.bzl", "scalapb_proto_library")
scalapb_proto_library(
    name = "my_scala_proto_lib",
    deps = [":my_target"],
)
```

`scalapb_proto_library` generates a Scala library of Scala proto bindings
generated by the [ScalaPB compiler](https://github.com/scalapb/ScalaPB).

## Attributes

| Attribute name        | Description                                           |
| --------------------- | ----------------------------------------------------- |
| name                  | `Name, required` <br> A unique name for this target.
| deps                  | `List of labels, required` <br> A list of `proto_library` targets for which to generate Scala code.

## Configuration (via `scalapb_toolchain`)

To configure ScalaPB options, configure a different `scalapb_toolchain` and declare it in a `BUILD` file:

```python
load("@io_bazel_rules_scala//scalapb:scalapb_toolchain.bzl", "scalapb_toolchain")

scalapb_toolchain(
    name = "scalapb_toolchain_configuration",
    with_grpc = False,
    with_flat_package = False,
    with_single_line_to_string = False,
    visibility = ["//visibility:public"],
)

toolchain(
    name = "scalapb_toolchain",
    toolchain = ":scalapb_toolchain_configuration",
    toolchain_type = "@io_bazel_rules_scala//scalapb:toolchain_type",
    visibility = ["//visibility:public"],
)
```

### Toolchain Attributes

| Attribute name                | Description                                           |
| ----------------------------- | ----------------------------------------------------- |
| name                          | `Name, required` <br> A unique name for this toolchain.
| with_grpc                     | `boolean, optional (default False)` <br> Enables generation of grpc service bindings for services.
| with_flat_package             | `boolean, optional (default False)` <br> When true, ScalaPB will not append the protofile base name to the package name.
| with_single_line_to_string    | `boolean, optional (default False)` <br> Enables generation of toString() methods that use a single line format.
| blacklisted_protos            | `List of labels, optional` <br> List of protobuf targets to exclude from recursive building.
| code_generator                | `Label, optional (has default)` <br> Which code generator to use. A sensible default is provided.
| named_generators              | `String dict, optional` <br>
| extra_generator_dependencies  | `List of labels, optional` <br>
| grpc_deps                     | `List of labels, optional (has default)` <br> gRPC dependencies. A sensible default is provided.
| implicit_compile_deps         | `List of labels, optional (has default)` <br> ScalaPB dependencies. A sensible default is provided.
| scalac                        | `Label, optional (has default)` <br> Target for scalac. A sensible default is provided.
